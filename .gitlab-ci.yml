variables:
  DOCKER_TLS_CERTDIR: ''

stages:
  - deploy

.swpc-runner:
  tags:
    - aws
    - m4-large

default:
  tags:
    - TPEA90099186

deploy:
  stage: deploy
  image: docker:19.03.8
  services:
    - docker:19.03.8-dind
  only:
    refs:
      - tags
  variables:
    USER: $SSOT_USER_NAME
    TOKEN: $SSOT_USER_TOKEN
  before_script:
    - echo "$TOKEN" | docker login -u $USER --password-stdin harbor.wistron.com
  script:
    - docker build --build-arg STAGE=prod -t harbor.wistron.com/k8sprdwhqecossot2021/eco-ssot-frontend:$CI_COMMIT_TAG .
    - docker push harbor.wistron.com/k8sprdwhqecossot2021/eco-ssot-frontend:$CI_COMMIT_TAG
  cache: {}
  dependencies: []
